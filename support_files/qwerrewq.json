{
 "pkgname":"@PROJECT_NAME@",
 "pkgvermaj":"@PROJECT_VERSION_MAJOR@",
 "pkgvermin":"@PROJECT_VERSION_MINOR@",
 "pkgverbld":"@PROJECT_VERSION_PATCH@",
 "version":["printf","%s.%s.%s","pkgvermaj","pkgvermin","pkgverbld"],

 "Pkg Name":"Splintermail",
 "pkg name":["lower", "Pkg Name"],
 "Pkg_Name":["regex", "Pkg Name", " ", "_"],
 "pkg_name":["lower", "Pkg_Name"],
 "Pkg-Name":["regex", "Pkg Name", " ", "-"],
 "pkg-name":["lower", "Pkg-Name"],

 "osx_pkg_id":"com.splintermail.splintermail",

 "pkgdescr_short":"client application for Splintermail.com users",
 "pkgdescr_long":[{"width":null, "joiner":"\n"}, ["join", "joiner", ["list",
                  ["wrap", "width", "", "", ["get","pdl","p1"]],
                  ["wrap", "width", "  ", "     ", ["get","pdl","p2"]],
                  ["wrap", "width", "  ", "     ", ["get","pdl","p3"]]
                 ]]],
 "pdl":{"p1":"The `splintermail` application serves two purposes:",
         "p2":"1) It implements the \"crypto-in-the-middle\" (CITM) model, which is the glue that connects an email client on your computer to the fully encrypted email stored on the Splintermail.com server.  In CITM mode this application will host an IMAP server on your local machine which your email client can connect to.",
         "p3":"2) It is a tool for controlling your account on the command line, instead of going to the Splintermail.com website."
       },

 "optrow":[{"o":null},["list",
                       ["printf", "  %2s", ["get", "opts", "o", "short"]],
                       ["printf", "%-17s", ["printf", "%s %s",
                                            ["string", "o"],
                                            ["get", "opts", "o", "arg"]]],
                       ["join", "\n", ["list",
                        ["wrap", "52", "", "", ["printf", "%s %s",
                                                ["get", "opts", "o", "summary"],
                                                ["get", "opts", "o", "detail"]]],
                        ["null?", ["get", "opts", "o", "default"], null,
                         ["wrap", "52", "", "", ["printf", "Default: %s",
                                                 ["get", "opts", "o", "default"]]]]]]
                      ]],
 "print_help":{
     "opts_from_list":[{"l":null},
         ["prepost", "\"", "\\n\"", ["regex",
              ["expand", ["for", "opt", "l",
                                 ["call", "optrow", {"o":"opt"}]
                         ], "table"],
          "\"", "\\\""]
     ]],
     "1bullet2":[{"s":null},["prepost", "\"", "\\n\"",
        ["join","\n",["list",
           ["wrap", "79", "        ", "        ", ["get","man","files","config","1"]],
           "",
           ["prepost", "            ", "",
               ["join", "\n", ["get","man","files","config","bullets"]]],
           "",
           ["wrap", "79", "        ", "        ", ["get","man","files","config","2"]]
        ]]]],
    "os_specific_body":
        ["join","\n\n", ["list",
            "\"OPTIONS:\\n\"",
            "\"\\n\"",
            ["call", ["get","print_help","opts_from_list"],{"l":"opts_common"}],
            "\"\\n\"",
            "\"OPTIONS, citm-specific:\\n\"",
            "\"\\n\"",
            ["call", ["get","print_help","opts_from_list"],{"l":"opts_citm"}],
            "\"\\n\"",
            "\"OPTIONS, api_command-specific:\\n\"",
            "\"\\n\"",
            ["call", ["get","print_help","opts_from_list"],{"l":"opts_apis"}],
            "\"\\n\"",
            "\"API_COMMANDS:\\n\"",
            "\"\\n\"",
            ["prepost", "\"", "\\n\"",
                    ["regex",
                      ["expand", ["for", "a", "apilist",
                        ["list", ["printf", "  %-23s",
                                    ["printf", "%s %s",
                                        ["string", "a"],
                                        ["get", "apis", "a", "arg"]]],
                                    ["wrap", "49", "", "",
                                        ["printf", "%s  %s",
                                            ["get", "apis", "a", "short"],
                                            ["get", "apis", "a", "long"]]]
                                    ]
                                 ], "table"],
                      "\"", "\\\""]],
            "\"\\n\"",
            "\"FILES:\\n\"",
            "\"    Config Files:\\n\"",
            ["call",["get","print_help","1bullet2"],{"s":"config"}],
            "\"\\n\"",
            "\"    CITM Email Storage:\\n\"",
            ["call",["get","print_help","1bullet2"],{"s":"citm"}],
            "\"\\n\"",
            "\"    Per-User API Tokens:\\n\"",
            ["call",["get","print_help","1bullet2"],{"s":"accounts"}]
        ]]
 },
 "opts":{"--help":{"short":"-h",
                   "arg":"",
                   "summary":"Print help information and usage.",
                   "detail":"",
                   "default":null,
                   "completion":null},
         "--version":{"short":"-v",
                      "arg":"",
                      "summary":"Print version.",
                      "detail":"",
                      "default":null,
                      "completion":null},
         "--debug":{"short":"-D",
                    "arg":"",
                    "summary":"Show more verbose output.",
                    "detail":"Note that this option will print passwords to stdout in plain text.",
                    "default":null,
                    "completion":null},
         "--splintermail-dir":{"short":"-d",
                               "arg":"DIR",
                               "summary":"Where to store decrypted emails and account info.",
                               "detail":"",
                               "default":["get", "sm_dir"],
                               "completion":"dir"},
         "--config":{"short":"-c",
                     "arg":"FILE",
                     "summary":"Override default config file loading sequence.",
                     "detail":"",
                     "default":"(see FILES section)",
                     "completion":"file"},
         "--dump-conf":{"short":"",
                        "arg":"",
                        "summary":"Dump config options to stdout.",
                        "detail":"",
                        "default":null,
                        "completion":null},
         "--listen-port":{"short":"",
                          "arg":"PORT",
                          "summary":"Port number for the local IMAP server.",
                          "detail":"",
                          "default":"1993",
                          "completion":null},
         "--listen-addr":{"short":"",
                          "arg":"ADDR",
                          "summary":"Bind address for the local IMAP server.",
                          "detail":"",
                          "default":"127.0.0.1",
                          "completion":null},
         "--logfile":{"short":"-l",
                      "arg":"FILE",
                      "summary":"Location of the log file.",
                      "detail":"",
                      "default":"${splintermail-dir}/citm_log",
                      "completion":"file"},
         "--no-logfile":{"short":"-L",
                         "arg":"",
                         "summary":"No log file should be kept.",
                         "detail":"Good for systemd, which keeps logs based on stdin and stdout.",
                         "default":null,
                         "completion":null},
         "--cert":{"short":"",
                   "arg":"CERT",
                   "summary":"TLS certificate for the local IMAP server.",
                   "detail":"",
                   "default":"${splintermail-dir}/citm-127.0.0.1-cert.pem",
                   "completion":"file"},
         "--key":{"short":"",
                   "arg":"KEY",
                   "summary":"TLS key for the local IMAP server.",
                   "detail":"",
                   "default":"${splintermail-dir}/citm-127.0.0.1-key.pem",
                   "completion":"file"},
         "--user":{"short":"-u",
                   "arg":"EMAIL",
                   "summary":"Which account should be used for API_COMMAND.",
                   "detail":"This will take the form of a full email address.  Not necessary unless you use multiple Splintermail accounts on this computer.",
                   "default":null,
                   "completion":null},
         "--account-dir":{"short":"-a",
                          "arg":"DIR",
                          "summary":"Where per-account API tokens are stored.",
                          "detail":"",
                          "default":"(see FILES section)",
                          "completion":null}},

 "opts_list":["list", "--help",
                      "--version",
                      "--debug",
                      "--splintermail-dir",
                      "--config",
                      "--dump-conf",
                      "--listen-port",
                      "--listen-addr",
                      "--logfile",
                      "--no-logfile",
                      "--cert",
                      "--key",
                      "--user",
                      "--account-dir"],

 "opts_common":["list", "--help",
                        "--version",
                        "--debug",
                        "--config",
                        "--dump-conf"],

 "opts_citm":["list", "--listen-port",
                      "--listen-addr",
                      "--splintermail-dir",
                      "--logfile",
                      "--no-logfile",
                      "--cert",
                      "--key"],

 "opts_apis":["list", "--user",
                      "--account-dir"],

 "opts_w_arg":["for", "a", "opts_list", ["zero?", ["get","opts","a","arg"],
                                                  null,
                                                  ["string","a"]]],

 "apis":{"list_devices":{"short":"List devices keys registered to your account.",
                         "long":"Splintermail encrypts your stored emails to each device registered to your account.",
                         "arg":"",
                         "choices":null},
         "delete_device":{"short":"Unregister a device from your account.",
                          "long":"",
                          "arg":"FPR",
                          "choices":null},
         "list_tokens":{"short":"List API Tokens registered to your account.",
                        "long":"API Tokens are used to authorize changes to your account.",
                        "arg":"",
                        "choices":null},
         "delete_token":{"short":"Revoke an API Token.",
                         "long":"",
                         "arg":"TOKEN",
                         "choices":null},
         "list_aliases":{"short":"Show a list of all aliases on your account.",
                         "long":"",
                         "arg":"",
                         "choices":null},
         "add_random_alias":{"short":"Generate a new random alias.",
                             "long":"",
                             "arg":"",
                             "choices":null},
         "add_primary_alias":{"short":"Request ALIAS as a new primary alias.",
                              "long":"",
                              "arg":"ALIAS",
                              "choices":null},
         "delete_alias":{"short":"Delete ALIAS from your account.",
                         "long":"",
                         "arg":"ALIAS",
                         "choices":null},
         "account_info":{"short":"View a summary of your account information.",
                         "long":"",
                         "arg":"",
                         "choices":null},
         "spam_sorting":{"short":"Turn spam sorting on/off following spam analysis.",
                         "long":"Should be enabled for IMAP users.  Has no effect if spamassassin is turned off.",
                         "arg":"(on|off)",
                         "choices":["list","on","off"]},
         "spamassassin":{"short":"Turn spamassassin on/off for incoming emails.",
                         "long":"",
                         "arg":"(on|off)",
                         "choices":["list","on","off"]},
         "change_password":{"short":"Change your Splintermail account password.",
                            "long":"",
                            "arg":"",
                            "choices":null},
         "delete_all_aliases":{"short":"Quickly delete all your aliases.",
                               "long":"",
                               "arg":"",
                               "choices":null},
         "delete_all_mail":{"short":"Quickly delete all your mail from the server.",
                            "long":"",
                            "arg":"",
                            "choices":null}},
 "apilist":["list", "list_aliases",
                    "add_random_alias",
                    "add_primary_alias",
                    "delete_alias",
                    "list_devices",
                    "delete_device",
                    "list_tokens",
                    "delete_token",
                    "account_info",
                    "change_password"],

 "disabled_apis":["puke","spam_sorting",
                         "spamassassin",
                         "delete_all_aliases",
                         "delete_all_mail"],

 "apis_devices":["list", "list_devices", "delete_device"],
 "apis_tokens":["list", "list_tokens", "delete_token"],
 "apis_aliases":["list", "list_aliases",
                         "add_random_alias",
                         "add_primary_alias",
                         "delete_alias"],
 "apis_account":["list", "account_info",
                         "change_password"],
 "zshcomp_apis":[{"joiner":null,"l":null},["join","joiner",["for","a","l",
                ["printf","%s\\:\"%s\"",
                    ["string","a"],
                    ["get","apis","a","short"]]
                ]]],

 "apis_w_arg":["for", "a", "apilist", ["zero?", ["get","apis","a","arg"],
                                                null,
                                                ["string","a"]]],

 "manopt":[{"o":null},["join", "",["list",
                                   ".TP\n.BR ",
                                   ["zero?", ["get", "opts", "o", "short"],
                                       "",
                                       ["printf", "\"%2s\" \", \" ", ["get", "opts", "o", "short"]]],
                                   ["string", "o"],
                                   ["zero?", ["get", "opts", "o", "arg"], "\n",
                                     ["printf", " \" \\fI%s\\fR\"\n",
                                             ["get", "opts", "o", "arg"]]],
                                   ["get", "opts", "o", "summary"],
                                   "\n",
                                   ["get", "opts", "o", "detail"],
                                   ["null?", ["get", "opts", "o", "default"],
                                     "",
                                     ["printf", "\n\\rDefault: %s", ["get", "opts", "o", "default"]]]]]],
 "man_apicmd":[{"a":null},["join","",["list",
                                      ".TP\n.BR ",
                                      "a",
                                      ["zero?", ["get","apis","a","arg"],
                                          "",
                                          ["printf", " \" \\fI%s\\fR\"",
                                            ["get","apis","a","arg"]]],
                                      "\n",
                                      ["get","apis","a","short"]
                                      ]]],
 "man_escapes":[{"t":null},["regex","t","-", "\\-", "`(.*)`", "\\\\fB\\1\\\\fR"]],
 "man":{
   "1bullets2":[{"s":null},["join","\n",["list",
     ["wrap","79","","",["call","man_escapes",{"t":["get","man","files","s","1"]}]],
     "\\\"",
     ".RS",
     ".nf",
     ["regex",["join","\n",["get","man","files","s","bullets"]],"-","\\-"],
     ".fi",
     ".RE",
     "\\\"",
     ["wrap","79","","",["call","man_escapes",{"t":["get","man","files","s","2"]}]]
       ]]],
   "files":{
     "config":{
       "1":"By default, `splintermail` will parse the following config files in order, giving higher precedence to values found earlier in the search:",
       "bullets":["switch",["dynamic","OS"],
                  {"WINDOWS":["list", "%APPDATA%\\splintermail\\splintermail.conf",
                                      "C:\\Program Files\\splintermail\\splintermail.conf"],
                   "OSX":["list", "$HOME/.splintermail.conf",
                                  "/etc/splintermail.conf"],
                   "LINUX":["list", "$XDG_CONFIG_HOME/splintermail.conf",
                                    "$HOME/.splintermail.conf",
                                    "/etc/splintermail.conf"]},
                  ["puke"]],
       "2":"If a specific config file is provided via the the `--config`, the default config files are not read."},
     "citm":{
       "1":"When in CITM mode, `splintermail` will download encrypted emails, decrypt them, and store them in the following directory:",
       "bullets":["list", ["get", "sm_dir"]],
       "2":"This location can be altered using the `--splintermail-dir` option."},
     "accounts":{
       "1":"When in API_COMMAND mode, `splintermail` will read/write API tokens in the following directory:",
       "bullets":["switch",["dynamic","OS"],
                  {"WINDOWS":["list","%APPDATA%\\splintermail"],
                   "OSX":["list","$HOME/Library/splintermail"],
                   "LINUX":["list","$XDG_CONFIG_HOME/splintermail    # if $XDG_CONFIG_HOME is set",
                                   "$HOME/.cache/splintermail        # otherwise"]},
                  ["puke"]],
       "2":"This location can be configured using the `--account-dir` option."}
   }
 },

 "maintainer_name":"Splintermail Dev",
 "maintainer_email":"dev@splintermail.com",
 "maintainer_string":["printf", "%s <%s>", "maintainer_name", "maintainer_email"],

 "sm_dir":["switch", ["dynamic", "OS"],
             {"WINDOWS":"C:/ProgramData/splintermail"},
             "/var/lib/splintermail"],
 "share_dir":["switch", ["dynamic", "OS"],
              {"WINDOWS":["puke"],
               "OSX":"/usr/local/share/splintermail"},
              "/usr/share/splintermail"],
 "ca_name":"citm-127.0.0.1-ca.crt",
 "cert_name":"citm-127.0.0.1-cert.pem",
 "key_name":"citm-127.0.0.1-key.pem",
 "config_path":["switch", ["dynamic", "OS"],
                {"WINDOWS":["puke"]},
                "/etc/splintermail.conf"],

 "ca_common_name":"splintermail.localhost",
 "keygen":{"openssl_binary":["switch", ["dynamic", "OS"],
                             {"WINDOWS":"%x"}, "openssl"],
           "outdir":["switch", ["dynamic", "OS"],
                     {"WINDOWS":"%x"}, "$outdir/"],
           "openssl_cnf":["switch", ["dynamic", "OS"],
                          {"WINDOWS":"%x"}, "$openssl_cnf"],
           "stdin_name":["switch", ["dynamic", "OS"],
                          {"WINDOWS":"-"}, "/dev/stdin"],
           "ca_path":["printf","%s%s", ["get", "keygen", "outdir"], "ca_name"],
           "key_path":["printf","%s%s", ["get", "keygen", "outdir"], "key_name"],
           "cert_path":["printf","%s%s", ["get", "keygen", "outdir"], "cert_name"],
           "csr_path":["printf","%ssig_req.csr", ["get", "keygen", "outdir"]],
           "ca_subj":["printf","/C=US/O=Splintermail Localhost Authority/OU=Org/CN=%s",
                               "ca_common_name"],
           "cert_subj":"/C=US/O=Splintermail on localhost (127.0.0.1)/OU=Org/CN=127.0.0.1"
          },
 "generate_ca_key_args":["list",["get", "keygen", "openssl_binary"],
                                "genrsa", "2048"],
 "self_sign_ca_args":["list",["get", "keygen", "openssl_binary"],
                             "req", "-x509", "-new", "-nodes",
                             "-sha512", "-days", "3650",
                             "-config", ["get", "keygen", "openssl_cnf"],
                             "-key", ["get", "keygen", "stdin_name"],
                             "-out", ["get", "keygen", "ca_path"],
                             "-subj", ["get", "keygen", "ca_subj"]],
 "create_key_args":["list",["get", "keygen", "openssl_binary"],
                           "genrsa",
                           "-out", ["get", "keygen", "key_path"],
                           "2048"],
 "create_csr_args":["list",["get", "keygen", "openssl_binary"],
                           "req", "-new",
                           "-config", ["get", "keygen", "openssl_cnf"],
                           "-key", ["get", "keygen", "key_path"],
                           "-out", ["get", "keygen", "csr_path"],
                           "-subj", ["get", "keygen", "cert_subj"]],
 "sign_csr_args":["list",["get", "keygen", "openssl_binary"],
                         "x509", "-req", "-days", "3650", "-sha512",
                         "-extensions", "req_ext", "-CAcreateserial",
                         "-extfile", ["get", "keygen", "openssl_cnf"],
                         "-in", ["get", "keygen", "csr_path"],
                         "-CA", ["get", "keygen", "ca_path"],
                         "-CAkey", ["get", "keygen", "stdin_name"],
                         "-out", ["get", "keygen", "cert_path"]]
}
